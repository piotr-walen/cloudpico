{{ define "title" }}Dashboard · Cloudpico{{ end }}

{{ define "content" }}
<section class="dashboard">
  <h1>Dashboard</h1>
  <p class="lead">Weather stations and readings.</p>
  {{ with . }}
  <div class="station-selector-wrapper">
    <label for="station-selector">Station</label>
    <select id="station-selector"
            name="station_id"
            class="station-selector"
            hx-get="/partials/current-conditions"
            hx-trigger="change"
            hx-target="#current-conditions-container"
            hx-swap="innerHTML"
            hx-include="this">
      {{ range .Stations }}
      <option value="{{ .ID }}" {{ if eq $.SelectedStationID .ID }}selected{{ end }}>{{ .Name }}</option>
      {{ end }}
    </select>
  </div>
  {{ end }}
  <div id="current-conditions-container"
       class="dashboard-content"
       hx-get="/partials/current-conditions"
       hx-trigger="load, every 30s"
       hx-swap="innerHTML"
       hx-include="#station-selector">
    <p>Loading…</p>
  </div>
  <div class="history-section">
    <div class="history-header">
      <h2>History</h2>
      <div class="history-controls">
        <label for="history-range">Range</label>
        <select id="history-range" name="range" class="history-range">
          <option value="1h">1h</option>
          <option value="6h">6h</option>
          <option value="24h" selected>24h</option>
          <option value="7d">7d</option>
        </select>
      </div>
    </div>
    <div id="history-container"
         class="history-container"
         hx-get="/partials/history"
         hx-trigger="load, every 60s, change from:#station-selector, change from:#history-range"
         hx-swap="innerHTML"
         hx-include="#station-selector, #history-range">
      <p>Loading…</p>
    </div>
  </div>
</section>
{{ end }}
